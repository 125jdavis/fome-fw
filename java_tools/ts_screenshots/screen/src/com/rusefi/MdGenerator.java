package com.rusefi;

import com.rusefi.xml.*;

import java.io.FileWriter;
import java.io.IOException;
import java.util.Date;

public class MdGenerator {
    static String FOLDER;

    private static final String EOL = "\r\n";

    public static void main(String[] args) throws Exception {
//        FOLDER = "images/";
        FOLDER = "overview/TS_generated/";

        ContentModel contentModel = XmlUtil.readModel();

        FileWriter md = new FileWriter("rusEFI_project.md");

        for (TopLevelMenuModel topLevelMenuModel : contentModel.getTopLevelMenus()) {
            md.append("# " + topLevelMenuModel.getTitle() + EOL);
            md.append(getImageTag(topLevelMenuModel.getImageName()));
            md.append(EOL);
        }

        for (TopLevelMenuModel topLevelMenuModel : contentModel.getTopLevelMenus()) {

            md.append("# " + topLevelMenuModel.getTitle() + EOL);

            for (DialogModel dialogModel : topLevelMenuModel.getDialogs()) {
                appendDialog(md, dialogModel);
            }
        }

        md.write(EOL);
        md.write("generated by " + MdGenerator.class + " on " + new Date());
        md.write(EOL);
        md.close();
    }

    private static void appendDialog(FileWriter md, DialogModel dialogModel) throws IOException {
        md.append(getImageTag(dialogModel.getImageName()));
        for (FieldModel fieldModel : dialogModel.fields) {
            String tooltip = fieldModel.getTooltip();

            if (tooltip.length() > 0) {
                md.append(fieldModel.getUiName() + ": " + tooltip + EOL + EOL);
            }
        }
    }

    private static String getImageTag(String imageName) {
        String IMG_SUFFIX = ")" + EOL;
        String IMG_PREFIX = "![x](";

        return IMG_PREFIX + FOLDER + imageName + IMG_SUFFIX;
    }
}
